# 2023 한국항공대 자율주행 경진대회
## Turtlebot Quickstart Guide

자율주행경진대회 참가자들을 위한 가이드입니다.

### 목차
1. 터틀봇 사용법
   1.1 ROS Domain 설정
   1.2 터틀봇 켜고 끄기
2. Ubuntu
3. ROS2  
   3.1 Topic  
   3.2 Publisher, Subscriber  
   3.3 Service, Action  
4. 

### 1. 터틀봇 사용법
```
기계관 107호에 준비된 PC와 터틀봇은 경진대회 참가를 위해 모두 세팅되어 있습니다.  
기계관 107호에서 작업하실 경우 따로 PC나 터틀봇을 세팅하실 필요가 없으며,  
개인 노트북을 활용하여 작업을 하셔도 상관없으나 조교가 도움을 주기 어려울 수 있습니다.  
```

#### 1.1 ROS Domain 설정
먼저 독에 장착되어 있는 터틀봇 하나를 가져옵니다. 정면의 5개의 LED가 모두 점등되어 있을 경우 정상이며, Display를 통해 IP와 잔여 배터리의 양(70%)을 확인할 수 있습니다.  
![t1.jpg](../src/t1.jpg){: width="50%" height="50%"}  
Display에 표시된 ip주소, 위 사진의 경우 `192.168.50.134`를 확인하고 PC의 브라우저를 열어 뒤에 `:8080`을 붙여 주소창에 입력해주세요.  
![t2.png](../src/t2.png){: width="50%" height="50%"}  
`Application` -> `Configuration`에 들어가 `ROS2 Domain ID`를 확인해주세요. 아래 사진의 경우 `7`입니다.  
![t3.png](../src/t3.png){: width="50%" height="50%"}  
브라우저를 닫고 `Ctrl + Alt + T`를 눌러 터미널 창을 켠 후 `gedit ~/.bashrc` 또는 `eb`를 입력해주세요.  
![t4.png](../src/t4.png){: width="50%" height="50%"}  
텍스트 에디터가 뜨는데 마지막 줄에 있는 `export ROS_DOMAIN_ID=` 뒤에 아까 확인한 숫자를 넣고 `Save`후 끕니다.   
![t5.png](../src/t5.png){: width="50%" height="50%"}  
터미널 창에 sb를 눌러 바꾼 설정을 적용시킵니다.  
![t6.png](../src/t6.png){: width="50%" height="50%"}  
터틀봇과 PC가 통신할 준비를 완료했습니다.  
`ros2 topic list`를 입력하였을 때 다음과 같이 여러 토픽이 나오면 잘 연결된 것입니다.  
![t7.png](../src/t7.png){: width="50%" height="50%"}  

#### 1.2 터틀봇 켜고 끄기
오류가 발생하여 터틀봇을 끄고 싶을 경우 앞에 있는 라이트링이 있는 버튼을 7초간 누르시면 3번 깜빡하고 소리가 울리며 꺼집니다.  
다시 터틀봇을 켜고 싶을 경우 독에 장착하면 켜집니다.  
독에 장착되어 있을 경우 소리는 울리지만 꺼지지 않으며 독에서 장착이 해제되면 터틀봇이 꺼지게 됩니다.  

#### 주의사항
* 터틀봇을 사용하실 때 터틀봇 정면에 초록 LED가 5개 모두 점등되어야 원활한 작동이 가능합니다.  
* 터틀봇을 들어 바퀴가 땅에 닿지 않을 경우 바퀴 모터가 작동하지 않습니다. 이 때 MTR LED가 꺼지는 것은 정상입니다.   
* ssh를 통해 터틀봇 RPi에 진입하여 작업을 하지 말아주세요.  
* 터틀봇은 배터리 15% 미만에서 자동으로 작동이 정지됩니다. 배터리가 30% 이하로 떨어질 경우 충전독에 올려놓으시고 다른 터틀봇으로 교체해주시기 바랍니다.  
* 터틀봇이 독에 올려져 있을 경우 전원 관리를 위해 카메라 등 여러 기능이 작동하지 않을 수 있습니다.  
* 기타 오류로 터틀봇이 작동하지 않으면 조금 기다려보신 후 조교에게 연락바랍니다.  
* 다른 팀을 위해 사용 종료 후 터틀봇을 독에 올려 충전시켜 주세요. 종료할 필요는 없습니다.  

### 2. ROS2  
ROS를 처음 사용해보시는 분들을 위한 내용입니다. ROS2에 익숙하실 경우 넘어가셔도 됩니다.  
ROS는 Robot Operation System으로 로봇 소프트웨어 개발을 위한 프레임워크입니다. 로봇 개발을 위한 여러 범용적인 라이브러리와 도구 모음이라고 생각하시면 됩니다.  
우리는 ROS2 통신을 사용하여 터틀봇의 센서 데이터를 받고 그 데이터로 PC에서 처리를 한 뒤 다시 터틀봇으로 움직이는 명령을 전달하여 터틀봇을 움직일 수 있습니다.  
#### 2.1 Node, Topic, Message
노드는 명령을 실행하기 위한 프로세스 단위입니다. 보통 코드 하나 당 하나의 노드라고 보시면 됩니다.  
토픽은 노드들이 메세지를 교환하기 위해 
##### Topic 관련 명령어
* `ros2 topic list` : 현재 활성화된 토픽을 보여줍니다.  
* `ros2 topic echo <토픽이름>` : <토픽이름>으로 발행되는 메세지를 보여줍니다. ex) `ros2 topic echo /cmd_vel`
* `ros2 topic info <토픽이름>` : <토픽이름>의 Type과 Publisher, Subscriber 수를 보여줍니다. 
#### 2.2 Publisher, Subscriber  
#### 2.3 Service, Action  

### 3. Mapping & Navigation
#### 3.1 SLAM
#### 3.2 Rviz2
#### 3.3 Nav2
